{% extends app.request.xmlHttpRequest ? '::ajax-layout.html.twig' : '::internal/layout_filemanager.html.twig' %}
{% set pageTitle = 'FILE_TITLE'|trans %}
{% block pagecontent %}
    <div class="clearfix"> </div>
    <!-- BEGIN CONTAINER -->

    <div class="row">
        <div class="col-md-12">
            <!-- BEGIN BREADCRUMB-->
            {% include 'internal/breadcrumb.html.twig' with breadCrumb %}
            <!-- END BREADCRUMB-->
            <!-- BEGIN PAGE TITLE AND PANEL TABS -->
            {% include 'global/page-title-bar.html.twig' with {'pageTitle': 'FILE_FILES'|trans, 'contactId': '', 'tabs': tabs, 'hrefLink': true , 'roleCount' : '' , 'type':'', 'url' : '','columnsUrl':''} %}
            <!-- END PAGE TITLE AND PANEL TABS -->
            <!-- BEGIN UPLOAD AREA -->
            <div class="" id="filemanager-upload-error-container">
            </div>               
            <div class="fg-filemanager-upload-wrapper hide">
                <ul class="fg-filemanager-upload-items">
                    {% include 'CommonFilemanagerBundle:FileUpload:fileManagerUpload.html.twig' with {'module':'filemanager'} %}
                </ul>
            </div>
            <!-- END UPLOAD AREA -->
            <!--- START DATATABLE AREA  -->
            <div class="fg-filemanager-filelist-wrapper">
                <div class="fg-theme-green hide"  id="overview">
                    <div id='tooltip' class="tooltip"></div>
                    <div class="row" >
                        <div class="col-md-12  fg-right-zero fg-left-zero">     
                            <div class="col-md-6">
                                <div class="portlet box fg-theme-head">
                                    <div class="portlet-title">
                                        <div class="caption"> 
                                            <span class="step-title"> {{'TOTAL_SPACE'|trans}}</span> 
                                        </div>
                                    </div>
                                    <div class="portlet-body fg-dashboard-wrap fg-clear">
                                        <div class="fg-totalspace-block">
                                                <div id="fg-dev-piechart-totalspace" class="fg-piechart"></div>
                                        </div>
                                        <div class="fg-filemanager-overview-space-status">
                                            <div id="fg-usedspace" class="fg-left-col text-right col-xs-6">
                                                <div class="fg-used-space-status-in-digit"></div>
                                                <p class="fg-used-space-status-in-perct"></p>
                                                    
                                            </div>
                                            <div id="fg-totalspace" class="fg-right-col text-left col-xs-6">
                                                <div class="fg-tot-space-status-in-digit"><span id="total-space"></span> <i class="fa fa-info-circle fa-2x " data-toggle="tooltip" title="{{'TOTAL_SPACE_TOOLTIP'|trans}}"></i></div>
                                                <p >{{'TOTAL_SPACE'|trans}} </p>
                                                    
                                            </div>
                                                
                                        </div>
                                        {#<div><span id="fg-usedspace"></span><span  id="fg-totalspace"></span></div>#}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="portlet box fg-theme-head">
                                    <div class="portlet-title">
                                        <div class="caption">
                                            <span class="step-title">{{'SECTIONS'|trans}}</span>
                                        </div>
                                    </div>    
                                    <div class="portlet-body fg-dashboard-wrap">
                                            <div class="fg-sectionoverview-block">  
                                                <div id="fg-dev-pie-chart-section" class="fg-piechart"></div>
                                            </div>
                                    </div>
                                </div>
                            </div>            
                        </div>
                    </div>
                </div>
                <div class="row" id="fg-personal-datatable">
                    <div class="portlet-body new-table-height fg-datatable-wrapper hide" id="tableWrapper1">
                        <table class="dataTable
                               table
                               table-bordered
                               table-hover
                               table-condensed"
                               id="datatable-file-manager" dataTable-popover="true" dataTable-hover="true">
                            <thead>
                                <tr>
                                    <th><input type="checkbox" class="dataTable_checkall fg-dev-avoidicon-behaviour ">&nbsp;<i class="chk_cnt"></i></th>
                                    <th> {{'FILE_NAME'|trans}}  </th>
                                    <th> {{'FILE_SIZE'|trans}} </th>                               
                                    <th> {{'FILE_UPLOAD_ON'|trans}}</th>
                                    <th> {{'FILE_SOURCE'|trans}} </th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                    <div class="portlet-body new-table-height fg-datatable-wrapper hide" id="tableWrapper2">
                        <table class="dataTable
                               table
                               table-bordered
                               table-hover
                               table-condensed"
                               id="datatable-file-manager-documents" dataTable-popover="true" dataTable-hover="true">
                            <thead>
                                <tr>
                                    <th><input type="checkbox" class="dataTable_checkall fg-dev-avoidicon-behaviour">&nbsp;<i class="chk_cnt"></i></th>
                                    <th> {{'FILE_NAME'|trans}}  </th>
                                    <th> {{'FILE_SIZE'|trans}} </th>                               
                                    <th> {{'FILE_LIST_DOCUMENTS_TABLE_DATE'|trans}}</th>
                                    <th> {{'FILE_LIST_DOCUMENTS_TABLE_AUTHOR'|trans}} </th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                                
                      
                    <!-- CONTENT SECTION STARTED -->            
                    <div class="portlet-body new-table-height fg-datatable-wrapper hide fg-filemanager-filelist-wrapper" id="tableWrapper3">
                        <table class="dataTable
                               table
                               table-bordered
                               table-hover
                               table-condensed"
                               id="datatable-clubfile-manager" dataTable-popover="true" dataTable-hover="true">
                            <thead>
                                <tr>
                                    <th><input type="checkbox" class="dataTable_checkall fg-dev-avoidicon-behaviour fg-filemanager-list-checkall">&nbsp;<i class="chk_cnt"></i></th>
                                    <th> {{'FILE_NAME'|trans}}  </th>
                                    <th> {{'FILE_SIZE'|trans}} </th>                               
                                    <th> {{'FILE_LOG_DATE'|trans}}</th>
                                    <th> {{'FILE_LIST_DOCUMENTS_TABLE_AUTHOR'|trans}} </th>
                                    <th> {{'FILE_SOURCE'|trans}} </th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                                
                    <div class="portlet-body new-table-height fg-datatable-wrapper hide" id="tableWrapper4">
                        <table class="dataTable
                               table
                               table-bordered
                               table-hover
                               table-condensed"
                               id="datatable-file-manager-gallery" dataTable-popover="true" dataTable-hover="true">
                            <thead>
                                <tr>
                                    <th><input type="checkbox" class="dataTable_checkall fg-dev-avoidicon-behaviour">&nbsp;<i class="chk_cnt"></i></th>
                                    <th> {{'FILE_NAME'|trans}}  </th>
                                    <th> {{'FILE_SIZE'|trans}} </th>                               
                                    <th> {{'FILE_LIST_DOCUMENTS_TABLE_DATE'|trans}}</th>
                                    <th> {{'FILE_LIST_DOCUMENTS_TABLE_AUTHOR'|trans}} </th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                                          
                    <!-- CONTENT SECTION END -->             
                </div>
            </div>
        </div>
               
    {% if isSuperAdmin == 1 %}
        <div class="col-md-12" class="fg-margin-btm-10">
            <a href="{{path('filemanager_viruslog')}}" style='text-decoration: underline'>
                <i aria-hidden="true" class="fa fa-chevron-circle-right"></i> 
                <span>{{'FILE_VIRUSCHECK_LOG_LINK'|trans}}</span>
            </a>
        </div> 
        <div class="col-md-12">
            <a href="{{path('api_response_log')}}" style='text-decoration: underline'>
                <i aria-hidden="true" class="fa fa-chevron-circle-right"></i> 
                <span>{{'API_ACCESS_LOG_LINK'|trans}}</span>
            </a>
        </div> 
    {% endif %}                        
                               
    </div> 
    <div class="custom-popup">
        <div class="popover bottom"><div class="arrow"></div><div class="popover-content"></div></div>
    </div>
{% endblock %}
{% block customstylesheets %}
    <link href="{{ asset('bundles/commonFilemanager/css/fg-filemanager-styles.css')}}" rel="stylesheet" type="text/css"/>
{% endblock %}
{% block javascripts %} 
    <script src="{{ asset('bundles/commonFilemanager/js/FgFileManagerUploader.js')}}" type="text/javascript"></script>
    <script src="{{ asset('fgassets/global/js/jquery-fileupload/jquery.ui.widget.js')}}" type="text/javascript"></script>
    <script src="{{ asset('fgassets/global/js/jquery-fileupload/jquery.iframe-transport.js')}}" type="text/javascript"></script>
    <script src="{{ asset('fgassets/global/js/jquery-fileupload/jquery.fileupload.js')}}" type="text/javascript"></script>
    <script src="{{ asset('fgassets/global/js/FgFileUpload.js')}}" type="text/javascript"></script>
    <script src="{{ path('javascript_variables_handler', { 'contactId' : fgclub.get('contactId'), 'version': asset_version(),'updated': random(5000) }) }}" data-sr="{{fgclub.get('settingsUpdated')}}" type="text/javascript"></script>
     <script src="{{ asset('bundles/commonFilemanager/js/filemanager.js')}}" type="text/javascript"></script>
     <script src="{{ asset('bundles/commonFilemanager/js/Filemanager_datatable_actions.js')}}" type="text/javascript"></script>    
    <script>
        var filemanagerUploadSavePath = '{{path('filemanager_upload_save')}}';
        var mbtranslation = '{{'FILE_MB'|trans}}';
        var datatablePath = "{{path('filemanager_list', {'module' : 'MODULE' })}}";
        var downloadText = '{{'FG_DOWNLOAD_ZIP'|trans}}';
        var downloadAllText = '{{'FILE_ZIP_ALL'|trans}}';
        var replaceButtonText = '{{'FILE_REPLACE_BUTTON_TEXT'|trans}}';
        var saveButtonText = '{{'SAVE_FILES'|trans}}';
        var editText = '{{'FILE_EDIT'|trans}}';
        var logText = '{{'FG_LOG'|trans}}';
        var fileManagerData = {};
        var clubId = '{{fgclub.get('id')}}';
        var fileLogPath = '{{path('filemanager_log', {"filemanagerId":"|id|"}) }}';
        var fileManagerUploaderOptions = {
            wrapperContainer: '#uploader-container-template',
            dropZoneElement: '#fg-wrapper',
            fileListTemplate: 'filemanager-img-upload',
            fileListTemplateContainer: '#filemanager_uploader_form-content',
            progressBarContainer: '.fg-upload-progress',
            progressBarElement: '.progress-bar',
            removeElement: '.removeUploadedFile',
            uploadUrl: '{{path('public_file_upload_check',{'type':'filemanager'})}}',
            extraDataToTemplate: fileManagerData,
            onFileListAdd: 'FgFileManagerUploader.initElements',
            errorContainer: '#filemanager-upload-error-container',
            errorListTemplate: 'filemanager-uploader-errorlist-template',
            validationErrorTemplateId:'fileUploadErrorFM',
            fileListTemplatePlacement: 'append',
            progressAllCallBack:function(){ 
                if($('.filecontent').length > 0){
                    $("#filemanager_upload_save").removeClass('disabled');
                    $("#filemanager_upload_discard").removeClass('disabled');
                }
            },
            onFileUploadError:'FgFileManagerUploader.setErrorMessage',
            validations: {
                forbiddenFiletypes: '{{ forbiddenFiletypes }}', 
            }
        };

        var datatableAjaxPath = "{{path('filemanager_document_list_data')}}";
        var downloadPath = "{{ path('document_download', {'docId' : '|docId|', 'versionId': '|versionId|' }) }}";
        var teamDocEditUrl = "{{ path('document_settings_team_files', {'documentId' : '|docId|', 'offset': 0 }) }}";
        var workgroupDocEditUrl = "{{ path('document_settings_workgroup_files', {'documentId' : '|docId|', 'offset': 0 }) }}";
        var contactDocEditUrl = "{{ path('document_settings_contact_files', {'documentId' : '|docId|', 'offset': 0 }) }}";
        var clubDocEditUrl = "{{ path('document_settings_club_files', {'documentId' : '|docId|', 'offset': 0 }) }}";
        var filemanagerModalPopupPath = "{{path('filemanager_modal_popup')}}";
        var downloadGalleryPath = "{{path('filemanager_download_gallery')}}";
        var contactOverviewPath = "{{path('render_contact_overview', {'offset':'0','contact':'XXX'})}}";
        var adminFlag = '{{adminFlag}}';
        var contactId = '{{contactId}}';   
        // CONTENT TAB GLOBAL SECTION
        var contentfileDownloadPath = "{{path('filemanager_download', {'type':'name','file':'XXX'})}}";
        var baseUrl = '{{baseUrl}}';
        var contentAjaxpath = "{{path('filemanager_datatable_list',{'listType':'document','module':''})}}";
        contactUrl = "{{path('render_contact_overview', {'offset':'0','contact':'YYY'}) }}";
        var filemanagerRenamePath = '{{path('filemanager_rename_popup')}}'; 
        var fileLogPath = '{{path('filemanager_log', {"filemanagerId":"|id|"}) }}';
        var markDeletionPath = '{{path('filemanager_mark_delete')}}'; 
        var restoreFilePath = '{{path('filemanager_restore_file')}}';
        var pathdownloadZipPopup = '{{path('filemanager_download_zip_popup',{'type':'all'}) }}';
        var pathDeleteFilePopup = "{{path('filemanager_delete_file_popup')}}";
        var pathDeleteFile = "{{path('filemanager_delete_file')}}";
        var translationArray = {
                           'upload':"{{'FG_UPLOAD'|trans}}",
                           'downloadAll':"{{'FG_DOWNLOAD_ALL'|trans}}",
                           'rename'    :"{{'FG_RENAME'|trans}}",
                           'replace'   :"{{'FG_REPLACE'|trans}}",
                           'markdeleteAll'  :"{{'FG_MARK_DELETE_ALL'|trans}}",
                           'restoreAll':"{{'FG_RESTORE_ALL'|trans}}",
                           'log'       :"{{'FG_LOG'|trans}}",
                           'download'  :"{{'FG_DOWNLOAD_ZIP'|trans}}",
                           'markdelete'    :"{{'FG_MARK_DELETE'|trans}}",
                           'restore'    :"{{'FG_RESTORE'|trans}}",
                           'downloadZip' :"{{'FG_DOWNLOAD_ZIP'|trans}}",
                           'delete'      :"{{'FILE_DELETE'|trans}}",
                           'deleteAll'      :"{{'FILE_DELETE_ALL'|trans}}",
                           'uploadfile'      :"{{'FILE_UPLOAD'|trans}}",
            
                         };
        var fileSourceArray = [];
        fileSourceArray['SIMPLE EMAIL'] = "{{'FILE_SIMPLEMAIL_TEXT'|trans}}";
        fileSourceArray['NEWSLETTER'] = "{{'FILE_NEWSLETTER_TEXT'|trans}}";
        fileSourceArray['FILEMANAGER'] = "{{'FILE_FILEMANAGER_TEXT'|trans}}";
        fileSourceArray['CALENDAR'] = "{{'FILE_CALENDAR_TEXT'|trans}}";
        fileSourceArray['ARTICLE'] = "{{'FILE_ARTICLE_TEXT'|trans}}";
        fileSourceArray['profilepic'] = "{{'FILE_PROFILEPIC_TEXT'|trans}}";
        fileSourceArray['companylogo'] = "{{'FILE_COMPANYLOGO_TEXT'|trans}}";
        fileSourceArray['clublogo'] = "{{'FILE_CLUBLOGO_TEXT'|trans}}";
        fileSourceArray['invoice_header'] = "{{'FILE_INVOICEHEADER_TEXT'|trans}}";
        fileSourceArray['newsletter_header'] = "{{'FILE_NEWSLETTERHEADER_TEXT'|trans}}";
        fileSourceArray['website_bg'] = "{{'FILE_WEBSITEBG_TEXT'|trans}}";
        fileSourceArray['ad'] = "{{'FILE_AD_TEXT'|trans}}";
        fileSourceArray['messages'] = "{{'FILE_MESSAGES_TEXT'|trans}}";
        fileSourceArray['website_header'] = "{{'FILE_WEBSITEHEADER_TEXT'|trans}}";
        fileSourceArray['federation_icon'] = "{{'FILE_FEDERATIONICON_TEXT'|trans}}";
        fileSourceArray['contactfield_image'] = "{{'FILE_CONTACTFIELD_IMAGE_TEXT'|trans}}";
        fileSourceArray['contactfield_file'] = "{{'FILE_CONTACTFIELD_FILE_TEXT'|trans}}";
        fileSourceArray['contact_application_file'] = "{{'FILE_CONTACT_APPLICATION_FILE_TEXT'|trans}}";
        fileSourceArray['form_uploads'] = "{{'FILE_FORM_UPLOADS_TEXT'|trans}}";  
        fileSourceArray['website_settings'] = "{{'FILE_WEBSITE_SETTINGS_TEXT'|trans}}";
        fileSourceArray['website_portrait'] = "{{'FILE_WEBSITE_PORTRAIT_TEXT'|trans}}";
        
//CONTENT TAB SETTING AREA END
        var hoverable = clickable = true;
    </script>  
    <script src="{{ asset('bundles/commonFilemanager/js/listModuleFiles.js')}}" type="text/javascript"></script>
    <script src="{{ asset('fgcustom/js/charts/jquery.flot.min.js')}}" type="text/javascript"></script> 
    <script src="{{ asset('fgcustom/js/charts/jquery.flot.pie.min.js')}}" type="text/javascript"></script> 
    <script src="{{ asset('fgcustom/js/fg_custom_charts.js')}}" type="text/javascript"></script>
    <script type = "text/javascript">    
    var totalOverviewPath = '{{path('filemanager_totaloverview')}}';
        var sectionOverviewPath = '{{path('filemanager_sectionoverview')}}';
        var nodataMessage = "{{nodataMessage}}";
        var used = "{{'USED'|trans}}";
        $(function(){
            var headerData = {
                    'module': '{{fgclub.get('module') ? fgclub.get('module') : 'null'}}',
                    'level1': '{{app.request.attributes.get('level1') ? app.request.attributes.get('level1') : 'null'}}',
                    'level2': '{{app.request.attributes.get('level2') ? app.request.attributes.get('level2') : 'null'}}',
                    'moduleMenu': '{{fgclub.get('moduleMenu') ? fgclub.get('moduleMenu') : 'null'}}'
                };
                FgHeader.init("{{ path('display_header') }}", headerData);
                FilemanagerDatatable.checkboxEventInit(adminFlag);
                FilemanagerDatatable.selectallcheckboxEventInit(adminFlag);
        })
              
    </script>  
{% endblock %}