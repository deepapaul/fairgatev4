<?php

namespace Common\UtilityBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * FgCmClubAttributeRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class FgCmClubAttributeRepository extends EntityRepository
{
   /**
    * Function to get all club details
    *
    * @return array
    */
    public function getAllClubDetails()
    {
        $qb= $this->createQueryBuilder('ca')
                ->select('ca.privacyContact', 'a.fieldname', 'a.inputType', 'a.fieldtype')
                ->leftJoin('ca.attribute', 'a')
                ->setMaxResults(100);

        return $qb->getQuery()->getResult();
    }

    /**
     * Function to get profile details
     *
     * @param int $attributeId attribute id
     * @param int $clubId      Club id
     *
     * @return array
     */
    public function getProfileDetails($attributeId, $clubId)
    {
        $qb= $this->createQueryBuilder('ca')
                ->select('ca.isVisibleContact', 'ca.isSetPrivacyItself', 'ca.privacyContact', 'ca.isVisibleTeamadmin', 'ca.isChangableContact', 'ca.isChangableTeamadmin', 'ca.isConfirmContact', 'ca.isConfirmTeamadmin')
                ->where('ca.attribute=:attributeId')
                ->andWhere('ca.club=:clubId')
                ->setParameter('attributeId', $attributeId)
                ->setParameter('clubId', $clubId);

        $result = $qb->getQuery()->getResult();

        return $result[0];
    }
}
