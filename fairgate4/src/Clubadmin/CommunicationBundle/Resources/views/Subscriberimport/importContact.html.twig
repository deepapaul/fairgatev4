{% extends app.request.xmlHttpRequest ? '::ajax-layout.html.twig' : '::clubadmin/layout.html.twig' %}
{% set pageTitle = 'IMPORT_TO_SUBSCRIBER_CONTACTS'|trans %}
{% block pagecontent %}
<!-- BEGIN PAGE HEADER-->
<div class="row">
    <div class="col-md-12">
          <!-- BEGIN PAGE TITLE & BREADCRUMB-->
            {% include 'clubadmin/breadcrumb.html.twig' with {'breadCrumb':{'back': path('subscriber_list') }} %}
          <!-- END PAGE TITLE & BREADCRUMB-->
    </div>
</div>
<!-- BEGIN PAGE CONTENT-->

        <div class="row" data-body style="display:none">
            <div class="col-md-12">
                <div class="portlet-body fg-theme-green fg-theme-panel">
                  {#  <div class="col-md-4  col-sm-7 col-xs-12 propertiblk">                
                        <h3 class="page-title fg-page-title fg-left-zero">{{'IMPORT_TO_SUBSCRIBER_CONTACTS'|trans}}</h3>                
                    </div> #}
                  <div class="row">
                    {% set page_settings = { 'pagetitle':'true'}  %}
                    {% include 'clubadmin/page-title-bar.html.twig' with {'pageTitle': 'IMPORT_TO_SUBSCRIBER_CONTACTS'|trans , 'page_settings': page_settings  } %}     
                   </div>
                    <div class="fg-clear"></div>             
                    {% include 'ClubadminCommunicationBundle:Subscriberimport:importSample.html.twig' %}
                    <!-- BEGIN PAGE CONTENT-->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="portlet box fg-theme-head" id="form_wizard_1">
                                <div class="portlet-title">
                                    <div class="caption">
                                        <span class="step-title">
                                            {{'IMPORT_STEP'|trans}} 1 {{'IMPORT_STEP_OF'|trans}} 4</span>
                                    </div>      
                                </div>
                                <div class="portlet-body form">
                                       <div class="form-wizard">
                                            <div class="form-body">
                                                <ul class="nav nav-pills nav-justified steps">
                                                    <li>
                                                        <a href="#tab1" data-toggle="tab" class="step">
                                                            <span class="number">
                                                                1 </span>
                                                            <span class="desc">
                                                                <i class="fa fa-check"></i>{%trans%}SUBSCRIBER_IMPORT_FILE{%endtrans%}</span>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a href="#tab2" data-toggle="tab" class="step">
                                                            <span class="number">
                                                                2 </span>
                                                            <span class="desc">
                                                                <i class="fa fa-check"></i>{%trans%}SUBSCRIBER_IMPORT_DATA_ASSIGNMENT{%endtrans%}</span>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a href="#tab3" data-toggle="tab" class="step active">
                                                            <span class="number">
                                                                3 </span>
                                                            <span class="desc">
                                                                <i class="fa fa-check"></i>{%trans%}SUBSCRIBER_IMPORT_FILE_CORRECTION{%endtrans%}</span>
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a href="#tab4" data-toggle="tab" class="step">
                                                            <span class="number">
                                                                4 </span>
                                                            <span class="desc">
                                                                <i class="fa fa-check"></i>{%trans%}SUBSCRIBER_IMPORT_NOT_IMPORT{%endtrans%}</span>
                                                        </a>
                                                    </li>
                                                    
                                                </ul>
                                                <div id="bar" class="progress progress-striped" role="progressbar">
                                                    <div class="progress-bar progress-bar-warning">
                                                    </div>
                                                </div>
                                                <div class="tab-content">
                                                    <div class="alert alert-danger display-none">
                                                        <button class="close" data-dismiss="alert"></button>
                                                        <span data-error>{%trans%}FORM_ERROR_DISPLAY{%endtrans%}</span>
                                                    </div>
                                                    
                                                    <div class="tab-pane active" id="tab1">
                                                        <div class="alert alert-danger display-none">
                                                            <button class="close" data-dismiss="alert"></button>
                                                            <span data-error>{%trans%}FORM_ERROR_DISPLAY{%endtrans%}</span>
                                                        </div>
                                                        <form id="form-tab1" method="post" data-url="{{ path('subscriber_import_data_assignment') }}" skipDirtyCheck onsubmit="return false;" autocomplete="off" novalidate="novalidate" class="form-horizontal">
                                                        <h3 class="block">{%trans%}SUBSCRIBER_IMPORT_CHOOSE_DETAILS{%endtrans%}&hellip;</h3>
                                                        
                                                        <div class="form-group">
                                                            <label class="col-md-3 control-label">{%trans%}CSV_TYPE{%endtrans%}</label>
                                                            <div class="col-md-9">
                                                                <div class="radio-list">
                                                                    <label class="radio-inline">
                                                                        <input type="radio" name="csvType" id="optionsRadios25" value="semicolon" checked> {%trans%}SEMICOLON_SEPARATED{%endtrans%}</label>
                                                                    <label class="radio-inline">
                                                                        <input type="radio" name="csvType" id="optionsRadios26" value="comma" > {%trans%}COMMA_SEPARATED{%endtrans%}</label>
                                                                </div>
                                                            </div>                    
                                                        </div>
                                                        
                                                        <div class="form-group form-group-last">
                                                            <div class="col-md-9">
                                                                <div class="fileinput fileinput-{{ (dataValue is defined) ? 'exists' :'new'}}" data-provides="fileinput">
                                                                    <span class="btn default btn-file">
                                                                        <span class="fileinput-new">{{'FILE_UPLOAD'|trans}}</span>
                                                                        <span class="fileinput-exists">{{'FILE_CHANGE'|trans}} </span>
                                                                        <input type="file" title="" name="importFile" id="importFile">
                                                                    </span>
                                                                    <span class="fileinput-filename">{{ (dataValue is defined) ? dataValue :''}}</span>
                                                                    &nbsp; <a href="#" class="close fileinput-exists" data-dismiss="fileinput" data-fileId=""></a>
                                                                </div>
                                                                <p class="help-block display-none" data-required>{%trans%}VALIDATION_THIS_FIELD_REQUIRED{%endtrans%}</p>  
                                                                <p class="help-block">{%trans%}ALLOWED_FILE_CSV{%endtrans%}</p>
                                                                <p class="help-block">{%trans%}CHECK_USER_GUIDE{%endtrans%}</p>
                                                            </div>
                                                        </div>
                                                        </form>
                                                    </div>
                                                    <div class="tab-pane" id="tab2"></div>
                                                    <div class="tab-pane" id="tab3"></div>
                                                    <div class="tab-pane" id="tab4"></div>
                                                    
                                                </div>
                                            </div>
                                            <div class="form-actions right">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="col-md-offset-9">
                                                            <a href="javascript:;" class="btn default button-previous">
                                                                {%trans%}BACK{%endtrans%} </a>
                                                            <a href="javascript:;" class="btn green button-next pull-right">
                                                                {%trans%}CONTINUE_BTN{%endtrans%}
                                                            </a>
                                                            <a href="javascript:;" class="btn green button-submit">
                                                                {%trans%}IMPORT_BTN{%endtrans%} 
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END PAGE CONTENT-->

{% endblock %}
{% block javascripts %}
      <script src="{{ asset('fgassets/assets/global/plugins/bootstrap-wizard/jquery.bootstrap.wizard.min.js')}}" type="text/javascript"></script>
      <script src="{{ asset('fgcustom/js/custom-form-wizard_subscriber.js')}}" type="text/javascript"></script>
<script type="text/javascript">
  var offset; var limit;
  var mappingError= " {%trans%}IMPORT_DUPLICATE_ASSIGNMENTS{%endtrans%}";
  var mandatoryError= " {%trans%}IMPORT_MANDATORY_ERROR{%endtrans%}";
  var columnSkippError= " {%trans%}IMPORT_NOT_SKIPPED_ERROR{%endtrans%}";
  var importStep= "{%trans%}IMPORT_STEP{%endtrans%} ";
  var importOf= " {%trans%}IMPORT_STEP_OF{%endtrans%} ";
  var manFiledError={};
  $(window).resize(function(){
    if(window.screen.width < 768){
         $('div.portlet-body').children('ul').hide();
         $('div.portlet-body').children('.row:last').hide();
         $('div.portlet-body div[data-sample]').children('.alert-info').hide();
         $('div.portlet-body div[data-sample]').children('.alert-danger').show();
    }
    else{
         $('div.portlet-body').children('ul').show();
         $('div.portlet-body').children('.row:last').show();
         $('div.portlet-body div[data-sample]').children('.alert-info').show();
         $('div.portlet-body div[data-sample]').children('.alert-danger').hide();
    }
    $('div[data-body]').show();
  });
  jQuery(document).ready(function() { 
     $('div[data-body]').show();
     FormWizardSubscriber.init();
     dataAssignments.init();
  });
  $(document).on('click','.nav-tabs a[data-url]',function(){
      document.location = $(this).attr('data-url');
  });
  $(document).on('change','#form-tab1 input[name=contactType]',function(){
      var contactType=$(this).val();
      $('table[data-sample-type]').hide();
      $('table[data-sample-type='+contactType+']').show();
  });

  var dataAssignments={
      handleDelete: function(){
          $('#tab2').on('click', 'input[data-inactiveblock=changecolor]', function() {
            $(this).closest('tr').toggleClass('danger');
            $(this).closest('tr').find('span[data-field]').toggleClass('display-none');
        });
      },
      handleImportFirstRow: function(){
            $('#tab2').on('change','input#not_import_first_row',function(){
                var columnClount=$('span[data-colCount]').html();
                var newCount= ($(this).is(':checked')) ? parseInt(columnClount)-1 :parseInt(columnClount)+1;
                $('span[data-colCount]').html(newCount);
                $('span[data-firstRow]').toggleClass('display-none');
            });
      },
      handleMandetory:function(){
        var manFileds={};
           $('table tr select:first option[data-req]').each(function(){
                var fieldReq=$(this).val();
                var manFiled=$(this).text();
                manFileds[fieldReq] = manFiled.replace('*', '');
           });
           return manFileds;
      },
      init:function(){
            this.handleDelete();
            this.handleImportFirstRow();
      }        
  }
   /*-------------- Page title bar configuration --------*/ 
            FgPageTitlebar.init({
                     title: true
             }); 
</script>
{% endblock %}
